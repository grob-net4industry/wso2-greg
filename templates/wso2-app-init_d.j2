#! /bin/sh
############## MANAGED BY ANSIBLE. DO NOT CHANGE #########################
### BEGIN INIT INFO
# Provides:          {{wso2_app}}
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: {{wso2_app}} init script
# Description:       Initialization script for the WSO2 governance registry
### END INIT INFO

# Author: J.P. Klousia
export JAVA_HOME='{{ java_home }}'
export CARBON_HOME={{carbon_home}}
startcmd='$CARBON_HOME/bin/wso2server.sh -DportOffset={{wso2_app_offset}} start > $CARBON_HOME/repository/logs/service.log &'
restartcmd='$CARBON_HOME/bin/wso2server.sh -DportOffset={{wso2_app_offset}} restart >  $CARBON_HOME/repository/logs/service.log &'
stopcmd='$CARBON_HOME/bin/wso2server.sh -DportOffset={{wso2_app_offset}} stop >  $CARBON_HOME/repository/logs/service.log &'
 
case "$1" in
start)
   echo "Starting the WSO2 Server ..."
   su -s /bin/bash -c "${startcmd}" {{ wso2_user }} 
;;
restart)
   echo "Re-starting the WSO2 Server ..."
   su -s /bin/bash -c "${restartcmd}" {{ wso2_user }}  
;;
stop)
   echo "Stopping the WSO2 Server ..."
   su -s /bin/bash -c "${stopcmd}" {{ wso2_user }} 
;;
*)
   echo "Usage: $0 {start|stop|restart}"
exit 1
esac
